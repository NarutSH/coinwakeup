{"ast":null,"code":"\"use strict\";\n\nvar http = require('follow-redirects').http,\n    https = require('follow-redirects').https,\n    ul = require(\"ul\"),\n    url = require(\"url\"),\n    queryString = require(\"querystring\"),\n    events = require(\"events\"),\n    EventEmitter = events.EventEmitter,\n    assured = require(\"assured\"),\n    noop = require(\"noop6\"),\n    zlib = require(\"zlib\");\n/**\n * tinyreq\n * Creates http(s) requests.\n *\n * @name tinyreq\n * @function\n * @param {String|Object} options A string being the request url or an object containing the following fields:\n *\n *  - `url` (String): The request url.\n *  - `method` (String): The request method.\n *  - `data` (Object): The request POST data.\n *  - `encoding` (String): The response encoding type.\n *  - `data_encoding` (String): The request encoding type.\n *\n * @param {Function} callback The callback function called (with `error` and `data` parameters).\n * @return {EventEmitter} An event emitter you can use for listening for the `data`, `error` and `end` events.\n */\n\n\nmodule.exports = function tinyreq(options, callback) {\n  // Handle options as string\n  if (typeof options === \"string\") {\n    options = {\n      url: options\n    };\n  } // Merge options\n\n\n  options = ul.deepMerge(options, ul.clone(url.parse(options.url)), {\n    method: options.method ? options.method : options.data ? \"POST\" : \"GET\",\n    headers: {},\n    encoding: \"utf8\"\n  });\n  var _done = false; // Unique callback\n\n  var opt_callback = assured(function (err, data, res) {\n    if (_done) {\n      return;\n    }\n\n    _done = true;\n\n    if (typeof callback !== \"function\") {\n      return;\n    }\n\n    callback(err, data, res);\n  }); // Handle post data\n\n  if (options.data && options.data.constructor === Object) {\n    options.data = queryString.stringify(options.data);\n  }\n\n  if (typeof options.data === \"string\") {\n    options.headers[\"Content-Length\"] = Buffer.byteLength(options.data);\n  }\n\n  var str = new EventEmitter(); // Create the request\n\n  var request = (options.protocol === \"http:\" ? http : https).request(options, function (res) {\n    var body = [],\n        bodyLength = 0;\n    var isGzipped = res.headers[\"content-encoding\"] === \"gzip\";\n    var resStream = res;\n\n    if (isGzipped) {\n      resStream = res.pipe(zlib.createGunzip());\n    } else {\n      options.encoding && res.setEncoding(options.encoding);\n    }\n\n    if (typeof callback === \"function\") {\n      resStream.on(\"data\", function (data) {\n        body.push(data);\n        bodyLength += data.length;\n      });\n    }\n\n    resStream.on(\"data\", function (data) {\n      str.emit(\"data\", data);\n    }).on(\"error\", function (e) {\n      str.emit(\"error\", e);\n      opt_callback(e, null, res);\n    }).on(\"end\", function () {\n      str.emit(\"end\");\n      body = options.encoding === null || options.encoding === \"buffer\" ? Buffer.concat(body, bodyLength) : body.join(\"\");\n      opt_callback(null, body, res);\n    });\n  }).on(\"error\", function (e) {\n    opt_callback(e, null, null);\n  }); // Handle post data\n\n  if (options.data) {\n    request.write(options.data, options.data_encoding);\n  }\n\n  request.end();\n\n  str.then = function (fn) {\n    callback = callback || noop;\n    return opt_callback._.then(fn);\n  };\n\n  str.catch = opt_callback._.catch.bind(opt_callback._);\n  return str;\n};","map":{"version":3,"sources":["C:/Users/narut/Documents/Coding/stock-calc/node_modules/tinyreq/lib/index.js"],"names":["http","require","https","ul","url","queryString","events","EventEmitter","assured","noop","zlib","module","exports","tinyreq","options","callback","deepMerge","clone","parse","method","data","headers","encoding","_done","opt_callback","err","res","constructor","Object","stringify","Buffer","byteLength","str","request","protocol","body","bodyLength","isGzipped","resStream","pipe","createGunzip","setEncoding","on","push","length","emit","e","concat","join","write","data_encoding","end","then","fn","_","catch","bind"],"mappings":"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","sourcesContent":["\"use strict\";\n\nvar http = require('follow-redirects').http,\n    https = require('follow-redirects').https,\n    ul = require(\"ul\"),\n    url = require(\"url\"),\n    queryString = require(\"querystring\"),\n    events = require(\"events\"),\n    EventEmitter = events.EventEmitter,\n    assured = require(\"assured\"),\n    noop = require(\"noop6\"),\n    zlib = require(\"zlib\");\n\n/**\n * tinyreq\n * Creates http(s) requests.\n *\n * @name tinyreq\n * @function\n * @param {String|Object} options A string being the request url or an object containing the following fields:\n *\n *  - `url` (String): The request url.\n *  - `method` (String): The request method.\n *  - `data` (Object): The request POST data.\n *  - `encoding` (String): The response encoding type.\n *  - `data_encoding` (String): The request encoding type.\n *\n * @param {Function} callback The callback function called (with `error` and `data` parameters).\n * @return {EventEmitter} An event emitter you can use for listening for the `data`, `error` and `end` events.\n */\nmodule.exports = function tinyreq(options, callback) {\n\n    // Handle options as string\n    if (typeof options === \"string\") {\n        options = {\n            url: options\n        };\n    }\n\n    // Merge options\n    options = ul.deepMerge(options, ul.clone(url.parse(options.url)), {\n        method: options.method ? options.method : options.data ? \"POST\" : \"GET\",\n        headers: {},\n        encoding: \"utf8\"\n    });\n\n    var _done = false;\n\n    // Unique callback\n    var opt_callback = assured(function (err, data, res) {\n        if (_done) {\n            return;\n        }\n        _done = true;\n        if (typeof callback !== \"function\") {\n            return;\n        }\n        callback(err, data, res);\n    });\n\n    // Handle post data\n    if (options.data && options.data.constructor === Object) {\n        options.data = queryString.stringify(options.data);\n    }\n\n    if (typeof options.data === \"string\") {\n        options.headers[\"Content-Length\"] = Buffer.byteLength(options.data);\n    }\n\n    var str = new EventEmitter();\n\n    // Create the request\n    var request = (options.protocol === \"http:\" ? http : https).request(options, function (res) {\n        var body = [],\n            bodyLength = 0;\n\n        var isGzipped = res.headers[\"content-encoding\"] === \"gzip\";\n\n        var resStream = res;\n        if (isGzipped) {\n            resStream = res.pipe(zlib.createGunzip());\n        } else {\n            options.encoding && res.setEncoding(options.encoding);\n        }\n\n        if (typeof callback === \"function\") {\n            resStream.on(\"data\", function (data) {\n                body.push(data);\n                bodyLength += data.length;\n            });\n        }\n\n        resStream.on(\"data\", function (data) {\n            str.emit(\"data\", data);\n        }).on(\"error\", function (e) {\n            str.emit(\"error\", e);\n            opt_callback(e, null, res);\n        }).on(\"end\", function () {\n            str.emit(\"end\");\n            body = options.encoding === null || options.encoding === \"buffer\" ? Buffer.concat(body, bodyLength) : body.join(\"\");\n            opt_callback(null, body, res);\n        });\n    }).on(\"error\", function (e) {\n        opt_callback(e, null, null);\n    });\n\n    // Handle post data\n    if (options.data) {\n        request.write(options.data, options.data_encoding);\n    }\n\n    request.end();\n    str.then = function (fn) {\n        callback = callback || noop;\n        return opt_callback._.then(fn);\n    };\n    str.catch = opt_callback._.catch.bind(opt_callback._);\n    return str;\n};"]},"metadata":{},"sourceType":"script"}