{"ast":null,"code":"import _objectSpread from\"C:/Users/narut/Documents/Coding/stock-calc/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"C:/Users/narut/Documents/Coding/stock-calc/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import{Line}from\"react-chartjs-2\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Chart=function Chart(_ref){var _quoteSpark$close,_quoteSummary$incomeS,_quoteSummary$incomeS2;var quoteSpark=_ref.quoteSpark,setRangeChart=_ref.setRangeChart,quoteSummary=_ref.quoteSummary;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),chartData=_useState2[0],setChartData=_useState2[1];var convertDate=function convertDate(value){var result=new Date(value*1000);var date=result.getDate();var month=result.getMonth()+1;var year=result.getFullYear();if(date<10){date=\"0\"+date;}if(month<10){month=\"0\"+month;}return\"\".concat(date,\"/\").concat(month,\"/\").concat(year);};var getStandardDeviation=function getStandardDeviation(dataArray){var n=dataArray===null||dataArray===void 0?void 0:dataArray.length;var mean=(dataArray===null||dataArray===void 0?void 0:dataArray.reduce(function(a,b){return a+b;}))/n;return+Math.sqrt((dataArray===null||dataArray===void 0?void 0:dataArray.map(function(x){return Math.pow(x-mean,2);}).reduce(function(a,b){return a+b;}))/n);};var getPrice=quoteSpark===null||quoteSpark===void 0?void 0:(_quoteSpark$close=quoteSpark.close)===null||_quoteSpark$close===void 0?void 0:_quoteSpark$close.map(function(item,index){return{price:item,year:new Date(quoteSpark.timestamp[index]*1000).getFullYear()};});var getEPS=quoteSummary===null||quoteSummary===void 0?void 0:(_quoteSummary$incomeS=quoteSummary.incomeStatementHistory)===null||_quoteSummary$incomeS===void 0?void 0:(_quoteSummary$incomeS2=_quoteSummary$incomeS.incomeStatementHistory)===null||_quoteSummary$incomeS2===void 0?void 0:_quoteSummary$incomeS2.map(function(item,index){return{eps:item.netIncome.raw/(quoteSummary===null||quoteSummary===void 0?void 0:quoteSummary.balanceSheetHistory.balanceSheetStatements[index].commonStock.raw),year:new Date(item.endDate.raw*1000).getFullYear()};});var getPE=getPrice===null||getPrice===void 0?void 0:getPrice.map(function(item,index){var resEps=getEPS===null||getEPS===void 0?void 0:getEPS.find(function(data){return data.year===item.year;});var resPe=resEps?+item.price/+resEps.eps:null;return _objectSpread(_objectSpread({},item),{},{eps:resEps?resEps.eps:null,pe:resPe});});var purePE=getPE===null||getPE===void 0?void 0:getPE.filter(function(item){return item.pe;});var getSD=getPE===null||getPE===void 0?void 0:getPE.map(function(item){var n=purePE===null||purePE===void 0?void 0:purePE.length;var meanPE=(purePE===null||purePE===void 0?void 0:purePE.map(function(item){return item.pe;}).reduce(function(a,b){return+a+ +b;}))/+n;var pe=purePE.map(function(item){return item.pe;});return _objectSpread(_objectSpread({},item),{},{sd:item.eps?+item.eps*meanPE:null,sd1p:item.eps?+item.eps*(meanPE+getStandardDeviation(pe)):null,sd2p:item.eps?+item.eps*(meanPE+getStandardDeviation(pe)*2):null,sd1m:item.eps?+item.eps*(meanPE-getStandardDeviation(pe)):null,sd2m:item.eps?+item.eps*(meanPE-getStandardDeviation(pe)*2):null});});var chartGenerate=function chartGenerate(){var _quoteSpark$timestamp,_quoteSpark$symbol;var labels=quoteSpark===null||quoteSpark===void 0?void 0:(_quoteSpark$timestamp=quoteSpark.timestamp)===null||_quoteSpark$timestamp===void 0?void 0:_quoteSpark$timestamp.map(function(item){return convertDate(item);});var datas={labels:labels,datasets:[{label:quoteSpark===null||quoteSpark===void 0?void 0:(_quoteSpark$symbol=quoteSpark.symbol)===null||_quoteSpark$symbol===void 0?void 0:_quoteSpark$symbol.replace(\".BK\",\"\"),backgroundColor:\"rgb(255, 99, 132)\",borderColor:\"rgb(255, 99, 132)\",pointRadius:\"0\",borderWidth:2,data:quoteSpark===null||quoteSpark===void 0?void 0:quoteSpark.close},{label:\"SD\",borderColor:\"gray\",borderDash:[10,5],pointRadius:\"0\",borderWidth:2,data:getSD?getSD.map(function(item){return item.sd;}):\"\"},{label:\"+1SD\",borderColor:\"gray\",borderDash:[10,5],pointRadius:\"0\",borderWidth:2,data:getSD?getSD.map(function(item){return item.sd1p;}):\"\"},{label:\"+2SD\",borderColor:\"gray\",borderDash:[10,5],pointRadius:\"0\",borderWidth:2,data:getSD?getSD.map(function(item){return item.sd2p;}):\"\"},{label:\"-1SD\",borderColor:\"gray\",borderDash:[10,5],pointRadius:\"0\",borderWidth:2,data:getSD?getSD.map(function(item){return item.sd1m;}):\"\"},{label:\"-2SD\",borderColor:\"gray\",borderDash:[10,5],pointRadius:\"0\",borderWidth:2,data:getSD?getSD.map(function(item){return item.sd2m;}):\"\"}]};setChartData(datas);};var options={scales:{x:{ticks:{maxTicksLimit:10,maxRotation:90,minRotation:90}}},plugins:{zoom:{zoom:{wheel:{enabled:true},pinch:{enabled:true},mode:\"xy\"},pan:{enabled:true,mode:\"xy\",speed:1,threshold:1}}// annotation: {\n// annotations: {\n// line1: {\n//   type: \"line\",\n//   yMin: getPE\n//     ? getStandardDeviation(getPE?.map((item) => item.pe))\n//     : \"\",\n//   // yMax: quoteSpark?.close,\n//   borderColor: \"green\",\n//   borderWidth: 2,\n// },\n// line2: {\n//   type: \"line\",\n//   xMin: transections[transections.length - 1].timeStamp,\n//   xMax: transections[transections.length - 1].timeStamp,\n//   borderColor: \"rgb(0, 0, 0)\",\n//   borderWidth: 2,\n// },\n// },\n// },\n}};useEffect(function(){if(quoteSpark)chartGenerate();},[quoteSpark]);var displayRange=/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between align-items-center my-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"input\",{onChange:function onChange(ev){return setRangeChart(ev.target.value);},name:\"range-chart\",type:\"radio\",className:\"btn-check\",id:\"range-1y\",value:\"1y\"}),/*#__PURE__*/_jsx(\"label\",{className:\"btn btn-outline-primary btn-sm\",htmlFor:\"range-1y\",children:\"1 Year\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"input\",{onChange:function onChange(ev){return setRangeChart(ev.target.value);},name:\"range-chart\",type:\"radio\",className:\"btn-check\",id:\"range-3y\",value:\"3y\",defaultChecked:true}),/*#__PURE__*/_jsx(\"label\",{className:\"btn btn-outline-primary btn-sm\",htmlFor:\"range-3y\",children:\"3 Year\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"input\",{onChange:function onChange(ev){return setRangeChart(ev.target.value);},name:\"range-chart\",type:\"radio\",className:\"btn-check\",id:\"range-5y\",value:\"5y\",defaultChecked:true}),/*#__PURE__*/_jsx(\"label\",{className:\"btn btn-outline-primary btn-sm\",htmlFor:\"range-5y\",children:\"5 Year\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"input\",{onChange:function onChange(ev){return setRangeChart(ev.target.value);},name:\"range-chart\",type:\"radio\",className:\"btn-check\",id:\"range-max\",value:\"max\"}),/*#__PURE__*/_jsx(\"label\",{className:\"btn btn-outline-primary btn-sm\",htmlFor:\"range-max\",children:\"Max\"})]})]});return/*#__PURE__*/_jsx(\"div\",{className:\"my-4\",children:quoteSpark?/*#__PURE__*/_jsxs(_Fragment,{children:[displayRange,/*#__PURE__*/_jsx(Line,{data:chartData,options:options})]}):\"\"});};export default Chart;","map":{"version":3,"sources":["C:/Users/narut/Documents/Coding/stock-calc/src/Component/Chart.js"],"names":["React","useState","useEffect","Line","Chart","quoteSpark","setRangeChart","quoteSummary","chartData","setChartData","convertDate","value","result","Date","date","getDate","month","getMonth","year","getFullYear","getStandardDeviation","dataArray","n","length","mean","reduce","a","b","Math","sqrt","map","x","pow","getPrice","close","item","index","price","timestamp","getEPS","incomeStatementHistory","eps","netIncome","raw","balanceSheetHistory","balanceSheetStatements","commonStock","endDate","getPE","resEps","find","data","resPe","pe","purePE","filter","getSD","meanPE","sd","sd1p","sd2p","sd1m","sd2m","chartGenerate","labels","datas","datasets","label","symbol","replace","backgroundColor","borderColor","pointRadius","borderWidth","borderDash","options","scales","ticks","maxTicksLimit","maxRotation","minRotation","plugins","zoom","wheel","enabled","pinch","mode","pan","speed","threshold","displayRange","ev","target"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { Line } from \"react-chartjs-2\";\r\n\r\nconst Chart = ({ quoteSpark, setRangeChart, quoteSummary }) => {\r\n  const [chartData, setChartData] = useState(\"\");\r\n\r\n  const convertDate = (value) => {\r\n    const result = new Date(value * 1000);\r\n\r\n    let date = result.getDate();\r\n    let month = result.getMonth() + 1;\r\n    let year = result.getFullYear();\r\n\r\n    if (date < 10) {\r\n      date = \"0\" + date;\r\n    }\r\n    if (month < 10) {\r\n      month = \"0\" + month;\r\n    }\r\n\r\n    return `${date}/${month}/${year}`;\r\n  };\r\n\r\n  const getStandardDeviation = (dataArray) => {\r\n    const n = dataArray?.length;\r\n    const mean = dataArray?.reduce((a, b) => a + b) / n;\r\n    return +Math.sqrt(\r\n      dataArray?.map((x) => Math.pow(x - mean, 2)).reduce((a, b) => a + b) / n\r\n    );\r\n  };\r\n\r\n  const getPrice = quoteSpark?.close?.map((item, index) => {\r\n    return {\r\n      price: item,\r\n      year: new Date(quoteSpark.timestamp[index] * 1000).getFullYear(),\r\n    };\r\n  });\r\n\r\n  const getEPS =\r\n    quoteSummary?.incomeStatementHistory?.incomeStatementHistory?.map(\r\n      (item, index) => {\r\n        return {\r\n          eps:\r\n            item.netIncome.raw /\r\n            quoteSummary?.balanceSheetHistory.balanceSheetStatements[index]\r\n              .commonStock.raw,\r\n          year: new Date(item.endDate.raw * 1000).getFullYear(),\r\n        };\r\n      }\r\n    );\r\n\r\n  const getPE = getPrice?.map((item, index) => {\r\n    const resEps = getEPS?.find((data) => data.year === item.year);\r\n    const resPe = resEps ? +item.price / +resEps.eps : null;\r\n\r\n    return {\r\n      ...item,\r\n      eps: resEps ? resEps.eps : null,\r\n      pe: resPe,\r\n    };\r\n  });\r\n\r\n  const purePE = getPE?.filter((item) => item.pe);\r\n\r\n  const getSD = getPE?.map((item) => {\r\n    const n = purePE?.length;\r\n    const meanPE =\r\n      purePE?.map((item) => item.pe).reduce((a, b) => +a + +b) / +n;\r\n\r\n    const pe = purePE.map((item) => item.pe);\r\n\r\n    return {\r\n      ...item,\r\n      sd: item.eps ? +item.eps * meanPE : null,\r\n      sd1p: item.eps ? +item.eps * (meanPE + getStandardDeviation(pe)) : null,\r\n      sd2p: item.eps\r\n        ? +item.eps * (meanPE + getStandardDeviation(pe) * 2)\r\n        : null,\r\n      sd1m: item.eps ? +item.eps * (meanPE - getStandardDeviation(pe)) : null,\r\n      sd2m: item.eps\r\n        ? +item.eps * (meanPE - getStandardDeviation(pe) * 2)\r\n        : null,\r\n    };\r\n  });\r\n\r\n  const chartGenerate = () => {\r\n    const labels = quoteSpark?.timestamp?.map((item) => convertDate(item));\r\n\r\n    const datas = {\r\n      labels: labels,\r\n      datasets: [\r\n        {\r\n          label: quoteSpark?.symbol?.replace(\".BK\", \"\"),\r\n          backgroundColor: \"rgb(255, 99, 132)\",\r\n          borderColor: \"rgb(255, 99, 132)\",\r\n          pointRadius: \"0\",\r\n          borderWidth: 2,\r\n          data: quoteSpark?.close,\r\n        },\r\n        {\r\n          label: \"SD\",\r\n\r\n          borderColor: \"gray\",\r\n          borderDash: [10, 5],\r\n          pointRadius: \"0\",\r\n          borderWidth: 2,\r\n          data: getSD ? getSD.map((item) => item.sd) : \"\",\r\n        },\r\n        {\r\n          label: \"+1SD\",\r\n\r\n          borderColor: \"gray\",\r\n          borderDash: [10, 5],\r\n          pointRadius: \"0\",\r\n          borderWidth: 2,\r\n          data: getSD ? getSD.map((item) => item.sd1p) : \"\",\r\n        },\r\n        {\r\n          label: \"+2SD\",\r\n\r\n          borderColor: \"gray\",\r\n          borderDash: [10, 5],\r\n          pointRadius: \"0\",\r\n          borderWidth: 2,\r\n          data: getSD ? getSD.map((item) => item.sd2p) : \"\",\r\n        },\r\n        {\r\n          label: \"-1SD\",\r\n\r\n          borderColor: \"gray\",\r\n          borderDash: [10, 5],\r\n          pointRadius: \"0\",\r\n          borderWidth: 2,\r\n          data: getSD ? getSD.map((item) => item.sd1m) : \"\",\r\n        },\r\n        {\r\n          label: \"-2SD\",\r\n\r\n          borderColor: \"gray\",\r\n          borderDash: [10, 5],\r\n          pointRadius: \"0\",\r\n          borderWidth: 2,\r\n          data: getSD ? getSD.map((item) => item.sd2m) : \"\",\r\n        },\r\n      ],\r\n    };\r\n\r\n    setChartData(datas);\r\n  };\r\n\r\n  let options = {\r\n    scales: {\r\n      x: {\r\n        ticks: {\r\n          maxTicksLimit: 10,\r\n          maxRotation: 90,\r\n          minRotation: 90,\r\n        },\r\n      },\r\n    },\r\n    plugins: {\r\n      zoom: {\r\n        zoom: {\r\n          wheel: {\r\n            enabled: true,\r\n          },\r\n          pinch: {\r\n            enabled: true,\r\n          },\r\n          mode: \"xy\",\r\n        },\r\n        pan: {\r\n          enabled: true,\r\n          mode: \"xy\",\r\n          speed: 1,\r\n          threshold: 1,\r\n        },\r\n      },\r\n\r\n      // annotation: {\r\n      // annotations: {\r\n      // line1: {\r\n      //   type: \"line\",\r\n      //   yMin: getPE\r\n      //     ? getStandardDeviation(getPE?.map((item) => item.pe))\r\n      //     : \"\",\r\n      //   // yMax: quoteSpark?.close,\r\n      //   borderColor: \"green\",\r\n      //   borderWidth: 2,\r\n      // },\r\n      // line2: {\r\n      //   type: \"line\",\r\n      //   xMin: transections[transections.length - 1].timeStamp,\r\n      //   xMax: transections[transections.length - 1].timeStamp,\r\n      //   borderColor: \"rgb(0, 0, 0)\",\r\n      //   borderWidth: 2,\r\n      // },\r\n      // },\r\n      // },\r\n    },\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (quoteSpark) chartGenerate();\r\n  }, [quoteSpark]);\r\n\r\n  const displayRange = (\r\n    <div className=\"d-flex justify-content-between align-items-center my-4\">\r\n      <div>\r\n        <input\r\n          onChange={(ev) => setRangeChart(ev.target.value)}\r\n          name=\"range-chart\"\r\n          type=\"radio\"\r\n          className=\"btn-check\"\r\n          id=\"range-1y\"\r\n          value=\"1y\"\r\n        />\r\n        <label className=\"btn btn-outline-primary btn-sm\" htmlFor=\"range-1y\">\r\n          1 Year\r\n        </label>\r\n      </div>\r\n      <div>\r\n        <input\r\n          onChange={(ev) => setRangeChart(ev.target.value)}\r\n          name=\"range-chart\"\r\n          type=\"radio\"\r\n          className=\"btn-check\"\r\n          id=\"range-3y\"\r\n          value=\"3y\"\r\n          defaultChecked\r\n        />\r\n        <label className=\"btn btn-outline-primary btn-sm\" htmlFor=\"range-3y\">\r\n          3 Year\r\n        </label>\r\n      </div>\r\n      <div>\r\n        <input\r\n          onChange={(ev) => setRangeChart(ev.target.value)}\r\n          name=\"range-chart\"\r\n          type=\"radio\"\r\n          className=\"btn-check\"\r\n          id=\"range-5y\"\r\n          value=\"5y\"\r\n          defaultChecked\r\n        />\r\n        <label className=\"btn btn-outline-primary btn-sm\" htmlFor=\"range-5y\">\r\n          5 Year\r\n        </label>\r\n      </div>\r\n      <div>\r\n        <input\r\n          onChange={(ev) => setRangeChart(ev.target.value)}\r\n          name=\"range-chart\"\r\n          type=\"radio\"\r\n          className=\"btn-check\"\r\n          id=\"range-max\"\r\n          value=\"max\"\r\n        />\r\n        <label className=\"btn btn-outline-primary btn-sm\" htmlFor=\"range-max\">\r\n          Max\r\n        </label>\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  return (\r\n    <div className=\"my-4\">\r\n      {quoteSpark ? (\r\n        <>\r\n          {displayRange}\r\n          <Line data={chartData} options={options} />\r\n        </>\r\n      ) : (\r\n        \"\"\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Chart;\r\n"]},"metadata":{},"sourceType":"module"}