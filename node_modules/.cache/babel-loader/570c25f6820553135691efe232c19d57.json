{"ast":null,"code":"import _objectSpread from\"C:/Users/narut/Documents/Coding/stock-calc/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"C:/Users/narut/Documents/Coding/stock-calc/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import{Line}from\"react-chartjs-2\";import useKeyPress from\"../Hooks/useKeyPress\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Chart=function Chart(_ref){var _quoteSpark$close,_quoteSummary$incomeS,_quoteSummary$incomeS2;var quoteSpark=_ref.quoteSpark,setRangeChart=_ref.setRangeChart,quoteSummary=_ref.quoteSummary;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),chartData=_useState2[0],setChartData=_useState2[1];var controlPressed=useKeyPress(\"Control\");var convertDate=function convertDate(value){var result=new Date(value*1000);var date=result.getDate();var month=result.getMonth()+1;var year=result.getFullYear();if(date<10){date=\"0\"+date;}if(month<10){month=\"0\"+month;}return\"\".concat(date,\"/\").concat(month,\"/\").concat(year);};var convertNumberRound=function convertNumberRound(value){return Math.round(value*100)/100;};var getStandardDeviation=function getStandardDeviation(dataArray){var n=dataArray===null||dataArray===void 0?void 0:dataArray.length;var mean=(dataArray===null||dataArray===void 0?void 0:dataArray.reduce(function(a,b){return a+b;}))/n;return+Math.sqrt((dataArray===null||dataArray===void 0?void 0:dataArray.map(function(x){return Math.pow(x-mean,2);}).reduce(function(a,b){return a+b;}))/n);};var getPrice=quoteSpark===null||quoteSpark===void 0?void 0:(_quoteSpark$close=quoteSpark.close)===null||_quoteSpark$close===void 0?void 0:_quoteSpark$close.map(function(item,index){return{price:item,year:new Date(quoteSpark.timestamp[index]*1000).getFullYear()};});var getEPS=quoteSummary===null||quoteSummary===void 0?void 0:(_quoteSummary$incomeS=quoteSummary.incomeStatementHistory)===null||_quoteSummary$incomeS===void 0?void 0:(_quoteSummary$incomeS2=_quoteSummary$incomeS.incomeStatementHistory)===null||_quoteSummary$incomeS2===void 0?void 0:_quoteSummary$incomeS2.map(function(item,index){return{eps:item.netIncome.raw/(quoteSummary===null||quoteSummary===void 0?void 0:quoteSummary.balanceSheetHistory.balanceSheetStatements[index].commonStock.raw),year:new Date(item.endDate.raw*1000).getFullYear()};});var getPE=getPrice===null||getPrice===void 0?void 0:getPrice.map(function(item,index){var resEps=getEPS===null||getEPS===void 0?void 0:getEPS.find(function(data){return data.year===item.year;});var resPe=resEps?+item.price/+resEps.eps:null;return _objectSpread(_objectSpread({},item),{},{eps:resEps?resEps.eps:null,pe:resPe?convertNumberRound(resPe):resPe});});var purePE=getPE===null||getPE===void 0?void 0:getPE.filter(function(item){return item.pe;});var getSD=getPE===null||getPE===void 0?void 0:getPE.map(function(item){var n=purePE===null||purePE===void 0?void 0:purePE.length;var meanPE=(purePE===null||purePE===void 0?void 0:purePE.map(function(item){return item.pe;}).reduce(function(a,b){return+a+ +b;}))/+n;var pe=purePE.map(function(item){return item.pe;});return _objectSpread(_objectSpread({},item),{},{sd:convertNumberRound(meanPE),sd1p:convertNumberRound(meanPE+getStandardDeviation(pe)),sd2p:convertNumberRound(meanPE+getStandardDeviation(pe)*2),sd1m:convertNumberRound(meanPE-getStandardDeviation(pe)),sd2m:convertNumberRound(meanPE-getStandardDeviation(pe)*2)});});var chartGenerate=function chartGenerate(){var _quoteSpark$timestamp,_quoteSpark$symbol;var labels=quoteSpark===null||quoteSpark===void 0?void 0:(_quoteSpark$timestamp=quoteSpark.timestamp)===null||_quoteSpark$timestamp===void 0?void 0:_quoteSpark$timestamp.map(function(item){return convertDate(item);});var datas={labels:labels,datasets:[{label:quoteSpark===null||quoteSpark===void 0?void 0:(_quoteSpark$symbol=quoteSpark.symbol)===null||_quoteSpark$symbol===void 0?void 0:_quoteSpark$symbol.replace(\".BK\",\"\"),backgroundColor:\"rgba(21, 101, 192, 1)\",borderColor:\"rgba(21, 101, 192, 1)\",pointRadius:\"0\",borderWidth:2,data:getSD.map(function(item){return item.pe;})},{label:\"+2SD\",borderColor:\"gray\",borderDash:[10,5],pointRadius:\"0\",borderWidth:2,data:getSD?getSD.map(function(item){return item.sd2p;}):\"\"},{label:\"+1SD\",borderColor:\"gray\",borderDash:[10,5],pointRadius:\"0\",borderWidth:2,data:getSD?getSD.map(function(item){return item.sd1p;}):\"\"},{label:\"Average\",borderColor:\"gray\",borderDash:[10,5],pointRadius:\"0\",borderWidth:2,data:getSD?getSD.map(function(item){return item.sd;}):\"\"},{label:\"-1SD\",borderColor:\"gray\",borderDash:[10,5],pointRadius:\"0\",borderWidth:2,data:getSD?getSD.map(function(item){return item.sd1m;}):\"\"},{label:\"-2SD\",borderColor:\"gray\",borderDash:[10,5],pointRadius:\"0\",borderWidth:2,data:getSD?getSD.map(function(item){return item.sd2m;}):\"\"}]};setChartData(datas);};var options={scales:{x:{ticks:{maxTicksLimit:5,maxRotation:0,minRotation:0}}},plugins:{zoom:{zoom:{wheel:{enabled:true// modifierKey: \"ctrl\",\n},pinch:{enabled:true},mode:controlPressed?\"xy\":\"x\"},pan:{enabled:true,mode:\"xy\",speed:1,threshold:1}}},interaction:{intersect:false,mode:\"index\"}};useEffect(function(){if(quoteSpark)chartGenerate();},[quoteSpark]);var displayRange=/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-around align-items-center my-1\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"input\",{onChange:function onChange(ev){return setRangeChart(ev.target.value);},name:\"range-chart\",type:\"radio\",className:\"btn-check\",id:\"range-1y\",value:\"1y\"}),/*#__PURE__*/_jsx(\"label\",{className:\"btn btn-outline-primary btn-sm px-5\",htmlFor:\"range-1y\",children:\"1Y\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"input\",{onChange:function onChange(ev){return setRangeChart(ev.target.value);},name:\"range-chart\",type:\"radio\",className:\"btn-check\",id:\"range-3y\",value:\"3y\",defaultChecked:true}),/*#__PURE__*/_jsx(\"label\",{className:\"btn btn-outline-primary btn-sm px-5\",htmlFor:\"range-3y\",children:\"3Y\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"input\",{onChange:function onChange(ev){return setRangeChart(ev.target.value);},name:\"range-chart\",type:\"radio\",className:\"btn-check\",id:\"range-5y\",value:\"5y\",defaultChecked:true}),/*#__PURE__*/_jsx(\"label\",{className:\"btn btn-outline-primary btn-sm px-5\",htmlFor:\"range-5y\",children:\"5Y\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"input\",{onChange:function onChange(ev){return setRangeChart(ev.target.value);},name:\"range-chart\",type:\"radio\",className:\"btn-check\",id:\"range-max\",value:\"max\"}),/*#__PURE__*/_jsx(\"label\",{className:\"btn btn-outline-primary btn-sm px-5\",htmlFor:\"range-max\",children:\"Max\"})]})]});return/*#__PURE__*/_jsx(\"div\",{children:quoteSpark?/*#__PURE__*/_jsxs(_Fragment,{children:[displayRange,/*#__PURE__*/_jsx(\"div\",{id:\"stock-chart\",className:\"shadow my-1 px-4 py-2\",children:/*#__PURE__*/_jsx(Line,{data:chartData,options:options,width:30,height:10})})]}):\"\"});};export default Chart;","map":{"version":3,"sources":["C:/Users/narut/Documents/Coding/stock-calc/src/Component/Chart.js"],"names":["React","useState","useEffect","Line","useKeyPress","Chart","quoteSpark","setRangeChart","quoteSummary","chartData","setChartData","controlPressed","convertDate","value","result","Date","date","getDate","month","getMonth","year","getFullYear","convertNumberRound","Math","round","getStandardDeviation","dataArray","n","length","mean","reduce","a","b","sqrt","map","x","pow","getPrice","close","item","index","price","timestamp","getEPS","incomeStatementHistory","eps","netIncome","raw","balanceSheetHistory","balanceSheetStatements","commonStock","endDate","getPE","resEps","find","data","resPe","pe","purePE","filter","getSD","meanPE","sd","sd1p","sd2p","sd1m","sd2m","chartGenerate","labels","datas","datasets","label","symbol","replace","backgroundColor","borderColor","pointRadius","borderWidth","borderDash","options","scales","ticks","maxTicksLimit","maxRotation","minRotation","plugins","zoom","wheel","enabled","pinch","mode","pan","speed","threshold","interaction","intersect","displayRange","ev","target"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { Line } from \"react-chartjs-2\";\r\nimport useKeyPress from \"../Hooks/useKeyPress\";\r\n\r\nconst Chart = ({ quoteSpark, setRangeChart, quoteSummary }) => {\r\n  const [chartData, setChartData] = useState(\"\");\r\n  const controlPressed = useKeyPress(\"Control\");\r\n\r\n  const convertDate = (value) => {\r\n    const result = new Date(value * 1000);\r\n\r\n    let date = result.getDate();\r\n    let month = result.getMonth() + 1;\r\n    let year = result.getFullYear();\r\n\r\n    if (date < 10) {\r\n      date = \"0\" + date;\r\n    }\r\n    if (month < 10) {\r\n      month = \"0\" + month;\r\n    }\r\n\r\n    return `${date}/${month}/${year}`;\r\n  };\r\n\r\n  const convertNumberRound = (value) => {\r\n    return Math.round(value * 100) / 100;\r\n  };\r\n\r\n  const getStandardDeviation = (dataArray) => {\r\n    const n = dataArray?.length;\r\n    const mean = dataArray?.reduce((a, b) => a + b) / n;\r\n    return +Math.sqrt(\r\n      dataArray?.map((x) => Math.pow(x - mean, 2)).reduce((a, b) => a + b) / n\r\n    );\r\n  };\r\n\r\n  const getPrice = quoteSpark?.close?.map((item, index) => {\r\n    return {\r\n      price: item,\r\n      year: new Date(quoteSpark.timestamp[index] * 1000).getFullYear(),\r\n    };\r\n  });\r\n\r\n  const getEPS =\r\n    quoteSummary?.incomeStatementHistory?.incomeStatementHistory?.map(\r\n      (item, index) => {\r\n        return {\r\n          eps:\r\n            item.netIncome.raw /\r\n            quoteSummary?.balanceSheetHistory.balanceSheetStatements[index]\r\n              .commonStock.raw,\r\n          year: new Date(item.endDate.raw * 1000).getFullYear(),\r\n        };\r\n      }\r\n    );\r\n\r\n  const getPE = getPrice?.map((item, index) => {\r\n    const resEps = getEPS?.find((data) => data.year === item.year);\r\n    const resPe = resEps ? +item.price / +resEps.eps : null;\r\n\r\n    return {\r\n      ...item,\r\n      eps: resEps ? resEps.eps : null,\r\n      pe: resPe ? convertNumberRound(resPe) : resPe,\r\n    };\r\n  });\r\n\r\n  const purePE = getPE?.filter((item) => item.pe);\r\n\r\n  const getSD = getPE?.map((item) => {\r\n    const n = purePE?.length;\r\n    const meanPE =\r\n      purePE?.map((item) => item.pe).reduce((a, b) => +a + +b) / +n;\r\n\r\n    const pe = purePE.map((item) => item.pe);\r\n\r\n    return {\r\n      ...item,\r\n      sd: convertNumberRound(meanPE),\r\n      sd1p: convertNumberRound(meanPE + getStandardDeviation(pe)),\r\n      sd2p: convertNumberRound(meanPE + getStandardDeviation(pe) * 2),\r\n      sd1m: convertNumberRound(meanPE - getStandardDeviation(pe)),\r\n      sd2m: convertNumberRound(meanPE - getStandardDeviation(pe) * 2),\r\n    };\r\n  });\r\n\r\n  const chartGenerate = () => {\r\n    const labels = quoteSpark?.timestamp?.map((item) => convertDate(item));\r\n\r\n    const datas = {\r\n      labels: labels,\r\n      datasets: [\r\n        {\r\n          label: quoteSpark?.symbol?.replace(\".BK\", \"\"),\r\n          backgroundColor: \"rgba(21, 101, 192, 1)\",\r\n          borderColor: \"rgba(21, 101, 192, 1)\",\r\n          pointRadius: \"0\",\r\n          borderWidth: 2,\r\n          data: getSD.map((item) => item.pe),\r\n        },\r\n        {\r\n          label: \"+2SD\",\r\n\r\n          borderColor: \"gray\",\r\n          borderDash: [10, 5],\r\n          pointRadius: \"0\",\r\n          borderWidth: 2,\r\n          data: getSD ? getSD.map((item) => item.sd2p) : \"\",\r\n        },\r\n\r\n        {\r\n          label: \"+1SD\",\r\n\r\n          borderColor: \"gray\",\r\n          borderDash: [10, 5],\r\n          pointRadius: \"0\",\r\n          borderWidth: 2,\r\n          data: getSD ? getSD.map((item) => item.sd1p) : \"\",\r\n        },\r\n\r\n        {\r\n          label: \"Average\",\r\n\r\n          borderColor: \"gray\",\r\n          borderDash: [10, 5],\r\n          pointRadius: \"0\",\r\n          borderWidth: 2,\r\n          data: getSD ? getSD.map((item) => item.sd) : \"\",\r\n        },\r\n\r\n        {\r\n          label: \"-1SD\",\r\n\r\n          borderColor: \"gray\",\r\n          borderDash: [10, 5],\r\n          pointRadius: \"0\",\r\n          borderWidth: 2,\r\n          data: getSD ? getSD.map((item) => item.sd1m) : \"\",\r\n        },\r\n        {\r\n          label: \"-2SD\",\r\n\r\n          borderColor: \"gray\",\r\n          borderDash: [10, 5],\r\n          pointRadius: \"0\",\r\n          borderWidth: 2,\r\n          data: getSD ? getSD.map((item) => item.sd2m) : \"\",\r\n        },\r\n      ],\r\n    };\r\n\r\n    setChartData(datas);\r\n  };\r\n\r\n  let options = {\r\n    scales: {\r\n      x: {\r\n        ticks: {\r\n          maxTicksLimit: 5,\r\n          maxRotation: 0,\r\n          minRotation: 0,\r\n        },\r\n      },\r\n    },\r\n\r\n    plugins: {\r\n      zoom: {\r\n        zoom: {\r\n          wheel: {\r\n            enabled: true,\r\n            // modifierKey: \"ctrl\",\r\n          },\r\n          pinch: {\r\n            enabled: true,\r\n          },\r\n          mode: controlPressed ? \"xy\" : \"x\",\r\n        },\r\n\r\n        pan: {\r\n          enabled: true,\r\n          mode: \"xy\",\r\n          speed: 1,\r\n          threshold: 1,\r\n        },\r\n      },\r\n    },\r\n\r\n    interaction: {\r\n      intersect: false,\r\n      mode: \"index\",\r\n    },\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (quoteSpark) chartGenerate();\r\n  }, [quoteSpark]);\r\n\r\n  const displayRange = (\r\n    <div className=\"d-flex justify-content-around align-items-center my-1\">\r\n      <div>\r\n        <input\r\n          onChange={(ev) => setRangeChart(ev.target.value)}\r\n          name=\"range-chart\"\r\n          type=\"radio\"\r\n          className=\"btn-check\"\r\n          id=\"range-1y\"\r\n          value=\"1y\"\r\n        />\r\n        <label\r\n          className=\"btn btn-outline-primary btn-sm px-5\"\r\n          htmlFor=\"range-1y\"\r\n        >\r\n          1Y\r\n        </label>\r\n      </div>\r\n      <div>\r\n        <input\r\n          onChange={(ev) => setRangeChart(ev.target.value)}\r\n          name=\"range-chart\"\r\n          type=\"radio\"\r\n          className=\"btn-check\"\r\n          id=\"range-3y\"\r\n          value=\"3y\"\r\n          defaultChecked\r\n        />\r\n        <label\r\n          className=\"btn btn-outline-primary btn-sm px-5\"\r\n          htmlFor=\"range-3y\"\r\n        >\r\n          3Y\r\n        </label>\r\n      </div>\r\n      <div>\r\n        <input\r\n          onChange={(ev) => setRangeChart(ev.target.value)}\r\n          name=\"range-chart\"\r\n          type=\"radio\"\r\n          className=\"btn-check\"\r\n          id=\"range-5y\"\r\n          value=\"5y\"\r\n          defaultChecked\r\n        />\r\n        <label\r\n          className=\"btn btn-outline-primary btn-sm px-5\"\r\n          htmlFor=\"range-5y\"\r\n        >\r\n          5Y\r\n        </label>\r\n      </div>\r\n      <div>\r\n        <input\r\n          onChange={(ev) => setRangeChart(ev.target.value)}\r\n          name=\"range-chart\"\r\n          type=\"radio\"\r\n          className=\"btn-check\"\r\n          id=\"range-max\"\r\n          value=\"max\"\r\n        />\r\n        <label\r\n          className=\"btn btn-outline-primary btn-sm px-5\"\r\n          htmlFor=\"range-max\"\r\n        >\r\n          Max\r\n        </label>\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  return (\r\n    <div>\r\n      {quoteSpark ? (\r\n        <>\r\n          {displayRange}\r\n          <div id=\"stock-chart\" className=\"shadow my-1 px-4 py-2\">\r\n            <Line data={chartData} options={options} width={30} height={10} />\r\n          </div>\r\n        </>\r\n      ) : (\r\n        \"\"\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Chart;\r\n"]},"metadata":{},"sourceType":"module"}